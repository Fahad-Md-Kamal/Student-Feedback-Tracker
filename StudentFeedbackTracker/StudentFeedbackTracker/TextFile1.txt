CREATE TABLE [dbo].[UserType] (
    [Id]    INT          IDENTITY (1, 1) NOT NULL,
    [tName] VARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);

INSERT INTO UserType VALUES ('ADMIN')
INSERT INTO UserType VALUES ('STUDENT')
INSERT INTO UserType VALUES ('STAFF')

CREATE TABLE [dbo].[User] (
    [Id]     INT          IDENTITY (1, 1) NOT NULL,
    [uName]  VARCHAR (50) NULL,
    [uPass]  VARCHAR (50) NULL,
    [typeId] INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [FK_User_ToUserType] FOREIGN KEY ([typeId]) REFERENCES [dbo].[UserType] ([Id])
);

CREATE TABLE [dbo].[Course] (
    [Id]    INT          IDENTITY (1, 1) NOT NULL,
    [cName] VARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);

INSERT INTO Course VALUES('L4DC')
INSERT INTO Course VALUES('L5DC')

CREATE TABLE [dbo].[Subject] (
    [Id]    INT          IDENTITY (1, 1) NOT NULL,
    [sName] VARCHAR (50) NULL,
    [cId]   INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [FK_Subject_ToCourse] FOREIGN KEY ([cId]) REFERENCES [dbo].[Course] ([Id])
);

INSERT INTO Subject VALUES('DDOOCP',1)
INSERT INTO Subject VALUES('Database',1)
INSERT INTO Subject VALUES('Web Design',1)

CREATE TABLE [dbo].[Student] (
    [Id]      INT          IDENTITY (1, 1) NOT NULL,
    [fName]   VARCHAR (50) NULL,
    [Address] VARCHAR (50) NULL,
    [DOB]     DATE         NULL,
    [Email]   VARCHAR (50) NULL,
    [RollNo]  VARCHAR (50) NULL,
    [cId]     INT          NULL,
    [uId]     INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    UNIQUE NONCLUSTERED ([Email] ASC),
    UNIQUE NONCLUSTERED ([RollNo] ASC),
    CONSTRAINT [FK_Student_ToCourse] FOREIGN KEY ([cId]) REFERENCES [dbo].[Course] ([Id]),
    CONSTRAINT [FK_Student_ToUser] FOREIGN KEY ([uId]) REFERENCES [dbo].[User] ([Id])
);



INSERT INTO [User] VALUES(
  'admin',
  '123',
  1
);

INSERT INTO Student VALUES(
    'Student of NCC' ,
    'UK',
    '1964/03/09',
    'NCC@gmail.com', 
    'S-001', 
    1, 
    1
);

CREATE TABLE [dbo].[Staff] (
    [Id]      INT          IDENTITY (1, 1) NOT NULL,
    [fName]   VARCHAR (50) NULL,
    [Address] VARCHAR (50) NULL,
    [DOB]     DATE         NULL,
    [Email]   VARCHAR (50) NULL,
    [Salary]  MONEY        NULL,
    [uId]     INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    UNIQUE NONCLUSTERED ([Email] ASC),
    CONSTRAINT [FK_Staff_ToUser] FOREIGN KEY ([uId]) REFERENCES [dbo].[User] ([Id])
);



--Change Here
CREATE TABLE [dbo].[AssessmentType] (
    [Id]      INT          IDENTITY (1, 1) NOT NULL,
    [assType] VARCHAR (50) NULL,
    [Mark]    INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);



CREATE TABLE [dbo].[SubjectAssessment] (
    [Id]   INT IDENTITY (1, 1) NOT NULL,
    [asId] INT NULL,
    [sId]  INT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [FK_SubjectAssessment_ToAssess] FOREIGN KEY ([asId]) REFERENCES [dbo].[AssessmentType] ([Id]),
    CONSTRAINT [FK_SubjectAssessment_ToSubject] FOREIGN KEY ([sId]) REFERENCES [dbo].[Subject] ([Id])
);



CREATE TABLE [dbo].[StudentCourse] (
    [Id]  INT IDENTITY (1, 1) NOT NULL,
    [cId] INT NULL,
    [uId] INT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [FK_StudentCourse_ToCourse] FOREIGN KEY ([cId]) REFERENCES [dbo].[Course] ([Id]),
    CONSTRAINT [FK_StudentCourse_ToUser] FOREIGN KEY ([uId]) REFERENCES [dbo].[User] ([Id])
);



CREATE TABLE [dbo].[Grade] (
    [Id]        INT          IDENTITY (1, 1) NOT NULL,
    [gradeSign] VARCHAR (10) NULL,
    [maxMark]   INT          NULL,
    [minMark]   INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);



CREATE TABLE [dbo].[Assessment] (
    [Id]       INT           IDENTITY (1, 1) NOT NULL,
    [cId]      INT           NULL,
    [mark]     INT           NULL,
    [uId]      INT           NULL,
    [gId]      INT           NULL,
    [assId]    INT           NULL,
    [assDate]  DATE          NULL,
    [assTitle] VARCHAR (100) NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [FK_Assessment_ToCourse] FOREIGN KEY ([cId]) REFERENCES [dbo].[Course] ([Id]),
    CONSTRAINT [FK_Assessment_ToUser] FOREIGN KEY ([uId]) REFERENCES [dbo].[User] ([Id]),
    CONSTRAINT [FK_Assessment_ToAssess] FOREIGN KEY ([assId]) REFERENCES [dbo].[AssessmentType] ([Id]),
    CONSTRAINT [FK_Assessment_ToGrade] FOREIGN KEY ([gId]) REFERENCES [dbo].[Grade] ([Id])
);





CREATE TABLE [dbo].[FeedbackType] (
    [Id]          INT          IDENTITY (1, 1) NOT NULL,
    [fType]       VARCHAR (10) NULL,
    [Description] VARCHAR (50) NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);



CREATE TABLE [dbo].[Feedback] (
    [Id]          INT          IDENTITY (1, 1) NOT NULL,
    [Keywords]    VARCHAR (50) NULL,
    [Description] VARCHAR (50) NULL,
    [fbTypeId]    INT          NULL,
    [assId]       INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [FK_Feedback_ToFeedbackType] FOREIGN KEY ([fbTypeId]) REFERENCES [dbo].[FeedbackType] ([Id]),
    CONSTRAINT [FK_Feedback_ToAssess] FOREIGN KEY ([assId]) REFERENCES [dbo].[Assessment] ([Id])
);



CREATE TABLE [dbo].[Note] (
    [Id]    INT          IDENTITY (1, 1) NOT NULL,
    [fbId]  INT          NULL,
    [Notes] VARCHAR (50) NULL,
    [uId]   INT          NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [FK_Note_ToFeedback] FOREIGN KEY ([fbId]) REFERENCES [dbo].[Feedback] ([Id]),
    CONSTRAINT [FK_Note_ToUser] FOREIGN KEY ([uId]) REFERENCES [dbo].[User] ([Id])
);



CREATE TABLE [dbo].[WordCloud] (
    [Id]          INT           IDENTITY (1, 1) NOT NULL,
    [Words]       VARCHAR (100) NULL,
    [Description] VARCHAR (50)  NULL,
    [fbId]        INT           NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC),
    CONSTRAINT [tblWCount] FOREIGN KEY ([fbId]) REFERENCES [dbo].[Feedback] ([Id])
);



